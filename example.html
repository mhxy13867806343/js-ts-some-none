<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rust-like Option Type in JavaScript</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }
        .section h2 {
            color: #2c3e50;
            margin-top: 0;
        }
        .code-block {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        .result {
            background-color: #e8f5e8;
            border: 1px solid #4caf50;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .error {
            background-color: #ffeaea;
            border: 1px solid #f44336;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        button:hover {
            background-color: #2980b9;
        }
        .output {
            min-height: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: white;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¦€ Rust-like Option Type in JavaScript</h1>
        
        <div class="section">
            <h2>åŸºæœ¬ç”¨æ³• - Some å’Œ None</h2>
            <div class="code-block">
// åˆ›å»º Some å’Œ None å®ä¾‹<br>
const someValue = Some(42);<br>
const noneValue = None();<br><br>
console.log(someValue.toString()); // "Some(42)"<br>
console.log(noneValue.toString()); // "None"
            </div>
            <button onclick="runBasicExample()">è¿è¡Œç¤ºä¾‹</button>
            <div id="basic-output" class="output"></div>
        </div>

        <div class="section">
            <h2>å®‰å…¨è§£åŒ… - unwrap å’Œ unwrapOr</h2>
            <div class="code-block">
// å®‰å…¨è§£åŒ…å€¼<br>
const value1 = Some("Hello").unwrap(); // "Hello"<br>
const value2 = Some("World").unwrapOr("Default"); // "World"<br>
const value3 = None().unwrapOr("Default"); // "Default"<br><br>
// å°è¯•è§£åŒ… None ä¼šæŠ›å‡ºé”™è¯¯<br>
try {<br>
&nbsp;&nbsp;None().unwrap();<br>
} catch (e) {<br>
&nbsp;&nbsp;console.log("é”™è¯¯:", e.message);<br>
}
            </div>
            <button onclick="runUnwrapExample()">è¿è¡Œç¤ºä¾‹</button>
            <div id="unwrap-output" class="output"></div>
        </div>

        <div class="section">
            <h2>å‡½æ•°å¼ç¼–ç¨‹ - map å’Œ filter</h2>
            <div class="code-block">
// ä½¿ç”¨ map è½¬æ¢å€¼<br>
const doubled = Some(5).map(x => x * 2); // Some(10)<br>
const noneDoubled = None().map(x => x * 2); // None<br><br>
// ä½¿ç”¨ filter è¿‡æ»¤å€¼<br>
const evenNumber = Some(4).filter(x => x % 2 === 0); // Some(4)<br>
const oddNumber = Some(3).filter(x => x % 2 === 0); // None
            </div>
            <button onclick="runMapExample()">è¿è¡Œç¤ºä¾‹</button>
            <div id="map-output" class="output"></div>
        </div>

        <div class="section">
            <h2>é“¾å¼æ“ä½œ - andThen</h2>
            <div class="code-block">
// å®‰å…¨çš„é™¤æ³•å‡½æ•°<br>
function safeDivide(a, b) {<br>
&nbsp;&nbsp;return b === 0 ? None() : Some(a / b);<br>
}<br><br>
// é“¾å¼æ“ä½œ<br>
const result1 = Some(10)<br>
&nbsp;&nbsp;.andThen(x => safeDivide(x, 2))<br>
&nbsp;&nbsp;.andThen(x => safeDivide(x, 2)); // Some(2.5)<br><br>
const result2 = Some(10)<br>
&nbsp;&nbsp;.andThen(x => safeDivide(x, 0))<br>
&nbsp;&nbsp;.andThen(x => safeDivide(x, 2)); // None
            </div>
            <button onclick="runChainExample()">è¿è¡Œç¤ºä¾‹</button>
            <div id="chain-output" class="output"></div>
        </div>

        <div class="section">
            <h2>æ¨¡å¼åŒ¹é… - match</h2>
            <div class="code-block">
// ä½¿ç”¨ match è¿›è¡Œæ¨¡å¼åŒ¹é…<br>
function processOption(opt) {<br>
&nbsp;&nbsp;return match(opt, [<br>
&nbsp;&nbsp;&nbsp;&nbsp;[Some, value => `æ‰¾åˆ°å€¼: ${value}`],<br>
&nbsp;&nbsp;&nbsp;&nbsp;[None, () => "æ²¡æœ‰å€¼"]<br>
&nbsp;&nbsp;]);<br>
}<br><br>
const msg1 = processOption(Some("æ•°æ®")); // "æ‰¾åˆ°å€¼: æ•°æ®"<br>
const msg2 = processOption(None()); // "æ²¡æœ‰å€¼"
            </div>
            <button onclick="runMatchExample()">è¿è¡Œç¤ºä¾‹</button>
            <div id="match-output" class="output"></div>
        </div>

        <div class="section">
            <h2>å®é™…åº”ç”¨ç¤ºä¾‹ - ç”¨æˆ·æŸ¥æ‰¾</h2>
            <div class="code-block">
// æ¨¡æ‹Ÿç”¨æˆ·æ•°æ®åº“<br>
const users = [<br>
&nbsp;&nbsp;{ id: 1, name: "å¼ ä¸‰", email: "zhangsan@example.com" },<br>
&nbsp;&nbsp;{ id: 2, name: "æå››", email: "lisi@example.com" }<br>
];<br><br>
// å®‰å…¨çš„ç”¨æˆ·æŸ¥æ‰¾å‡½æ•°<br>
function findUserById(id) {<br>
&nbsp;&nbsp;const user = users.find(u => u.id === id);<br>
&nbsp;&nbsp;return user ? Some(user) : None();<br>
}<br><br>
// è·å–ç”¨æˆ·é‚®ç®±<br>
function getUserEmail(id) {<br>
&nbsp;&nbsp;return findUserById(id)<br>
&nbsp;&nbsp;&nbsp;&nbsp;.map(user => user.email)<br>
&nbsp;&nbsp;&nbsp;&nbsp;.unwrapOr("æœªæ‰¾åˆ°ç”¨æˆ·");<br>
}
            </div>
            <button onclick="runUserExample()">è¿è¡Œç¤ºä¾‹</button>
            <div id="user-output" class="output"></div>
        </div>
    </div>

    <script src="option.js"></script>
    <script>
        function runBasicExample() {
            const output = document.getElementById('basic-output');
            try {
                const someValue = Some(42);
                const noneValue = None();
                
                output.innerHTML = `
                    <div class="result">
                        someValue.toString(): ${someValue.toString()}<br>
                        noneValue.toString(): ${noneValue.toString()}<br>
                        someValue.isSome(): ${someValue.isSome()}<br>
                        noneValue.isNone(): ${noneValue.isNone()}
                    </div>
                `;
            } catch (e) {
                output.innerHTML = `<div class="error">é”™è¯¯: ${e.message}</div>`;
            }
        }

        function runUnwrapExample() {
            const output = document.getElementById('unwrap-output');
            try {
                const value1 = Some("Hello").unwrap();
                const value2 = Some("World").unwrapOr("Default");
                const value3 = None().unwrapOr("Default");
                
                let errorMsg = "";
                try {
                    None().unwrap();
                } catch (e) {
                    errorMsg = e.message;
                }
                
                output.innerHTML = `
                    <div class="result">
                        Some("Hello").unwrap(): ${value1}<br>
                        Some("World").unwrapOr("Default"): ${value2}<br>
                        None().unwrapOr("Default"): ${value3}<br>
                        None().unwrap() é”™è¯¯: ${errorMsg}
                    </div>
                `;
            } catch (e) {
                output.innerHTML = `<div class="error">é”™è¯¯: ${e.message}</div>`;
            }
        }

        function runMapExample() {
            const output = document.getElementById('map-output');
            try {
                const doubled = Some(5).map(x => x * 2);
                const noneDoubled = None().map(x => x * 2);
                const evenNumber = Some(4).filter(x => x % 2 === 0);
                const oddNumber = Some(3).filter(x => x % 2 === 0);
                
                output.innerHTML = `
                    <div class="result">
                        Some(5).map(x => x * 2): ${doubled.toString()}<br>
                        None().map(x => x * 2): ${noneDoubled.toString()}<br>
                        Some(4).filter(x => x % 2 === 0): ${evenNumber.toString()}<br>
                        Some(3).filter(x => x % 2 === 0): ${oddNumber.toString()}
                    </div>
                `;
            } catch (e) {
                output.innerHTML = `<div class="error">é”™è¯¯: ${e.message}</div>`;
            }
        }

        function runChainExample() {
            const output = document.getElementById('chain-output');
            try {
                function safeDivide(a, b) {
                    return b === 0 ? None() : Some(a / b);
                }
                
                const result1 = Some(10)
                    .andThen(x => safeDivide(x, 2))
                    .andThen(x => safeDivide(x, 2));
                    
                const result2 = Some(10)
                    .andThen(x => safeDivide(x, 0))
                    .andThen(x => safeDivide(x, 2));
                
                output.innerHTML = `
                    <div class="result">
                        Some(10) -> /2 -> /2: ${result1.toString()}<br>
                        Some(10) -> /0 -> /2: ${result2.toString()}
                    </div>
                `;
            } catch (e) {
                output.innerHTML = `<div class="error">é”™è¯¯: ${e.message}</div>`;
            }
        }

        function runMatchExample() {
            const output = document.getElementById('match-output');
            try {
                function processOption(opt) {
                    return match(opt, [
                        [Some, value => `æ‰¾åˆ°å€¼: ${value}`],
                        [None, () => "æ²¡æœ‰å€¼"]
                    ]);
                }
                
                const msg1 = processOption(Some("æ•°æ®"));
                const msg2 = processOption(None());
                
                output.innerHTML = `
                    <div class="result">
                        processOption(Some("æ•°æ®")): ${msg1}<br>
                        processOption(None()): ${msg2}
                    </div>
                `;
            } catch (e) {
                output.innerHTML = `<div class="error">é”™è¯¯: ${e.message}</div>`;
            }
        }

        function runUserExample() {
            const output = document.getElementById('user-output');
            try {
                const users = [
                    { id: 1, name: "å¼ ä¸‰", email: "zhangsan@example.com" },
                    { id: 2, name: "æå››", email: "lisi@example.com" }
                ];
                
                function findUserById(id) {
                    const user = users.find(u => u.id === id);
                    return user ? Some(user) : None();
                }
                
                function getUserEmail(id) {
                    return findUserById(id)
                        .map(user => user.email)
                        .unwrapOr("æœªæ‰¾åˆ°ç”¨æˆ·");
                }
                
                const email1 = getUserEmail(1);
                const email2 = getUserEmail(999);
                
                output.innerHTML = `
                    <div class="result">
                        getUserEmail(1): ${email1}<br>
                        getUserEmail(999): ${email2}<br>
                        findUserById(1): ${findUserById(1).toString()}<br>
                        findUserById(999): ${findUserById(999).toString()}
                    </div>
                `;
            } catch (e) {
                output.innerHTML = `<div class="error">é”™è¯¯: ${e.message}</div>`;
            }
        }
    </script>
</body>
</html>